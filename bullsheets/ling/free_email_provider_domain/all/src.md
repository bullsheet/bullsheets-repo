3618 lines
https://gist.github.com/tbrianjones/5992856